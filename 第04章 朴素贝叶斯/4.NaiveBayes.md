# 朴素贝叶斯法

## 算法 4.1（朴素贝叶斯算法）

**输入**：训练数据集 $T = \{(x_1, y_1), (x_2, y_2), (x_N, y_N)\}$，其中 $x_i = (x_i^{(1)}, x_i^{(2)}, ..., x_i^{(n)})^T$，$x_i^{(j)}$ 是第 $i$ 个样本的第 $j$ 个特征，$x_i^{(j)} \in \{a_{j1}, a_{j2}, ..., a_{jS_j}\}$，$a_{jl}$ 是第 $j$ 个特征可能取的第 $l$ 个值，$j = 1, 2, ..., n$，$l = 1, 2, ..., S_j$，$y_i \in \{c_1, c_2, ..., c_K\}$；
**输出**：实例 $x$ 的分类。
（1）计算先验概率及条件概率

$$
P(Y=c_k) = \frac{\sum^N_{i=1}I(y_i=c_k)}{N},\ k = 1, 2, ..., K
$$

$$
P(X^{(j)}=a_{jl} | Y=c_k) = \frac{\sum^N_{i=1}I(x_i^{(j)}=a_{jl}, y_i=c_k)}{\sum^N_{i=1}I(y_i=c_k)}
$$

$$
j = 1, 2, ..., n;\ l = 1, 2, ..., S_j;\ k = 1, 2, ..., K
$$

（2）对于给定的实例 $x = (x^{(1)}, x^{(2)}, ..., x^{(n)})^T$，计算

$$
P(Y=c_k) \prod^n_{j=1}P(X^{(j)}=x^{(j)} | Y=c_k),\ k = 1, 2, ..., K
$$

（3）确定实例 $x$ 的类

$$
y = arg \max_{c_k}P(Y=c_k) \prod^n_{j=1}P(X^{(j)}=x^{(j)} | Y=c_k)
$$

### 例 4.1

试由表 4.1 的训练数据学习一个朴素贝叶斯分类器并确定 $x = (2, 5)^T$ 的类标记 $y$。表中 $X^{(1)}$，$X^{(2)}$ 为特征标签，取值的集合分别为 $A_1 = \{1, 2, 3\}$，$A_2 = \{S, M, L\}$，$Y$ 为类标记，$Y \in \{C=\{1, -1\}$。

表 4.1 训练数据

|           | 1    | 2    | 3   | 4   | 5    | 6    | 7    | 8   | 9   | 10  | 11  | 12  | 13  | 14  | 15   |
|:---------:|:----:|:----:|:---:|:---:|:----:|:----:|:----:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:----:|
| $X^{(1)}$ | $1$  | $1$  | $1$ | $1$ | $1$  | $2$  | $2$  | $2$ | $2$ | $2$ | $3$ | $3$ | $3$ | $3$ | $3$  |
| $X^{(1)}$ | $S$  | $M$  | $M$ | $S$ | $S$  | $S$  | $M$  | $M$ | $L$ | $L$ | $L$ | $M$ | $M$ | $L$ | $L$  |
| $Y$       | $-1$ | $-1$ | $1$ | $1$ | $-1$ | $-1$ | $-1$ | $1$ | $1$ | $1$ | $1$ | $1$ | $1$ | $1$ | $-1$ |

**解** 根据算法 4.1，

（1）由表 4.1 容易计算下列概率：

$$
P(Y=1) = \frac{9}{15},\ P(Y=-1) = \frac{6}{15}
$$

$$
P(X^{(1)}=1 | Y=1) = \frac{2}{9},\ P(X^{(1)}=2 | Y=1) = \frac{3}{9},\ P(X^{(1)}=3 | Y=1) = \frac{4}{9}
$$

$$
P(X^{(2)}=S | Y=1) = \frac{1}{9},\ P(X^{(2)}=M | Y=1) = \frac{4}{9},\ P(X^{(2)}=L | Y=1) = \frac{4}{9}
$$

$$
P(X^{(1)}=1 | Y=-1) = \frac{3}{6},\ P(X^{(1)}=2 | Y=-1) = \frac{2}{6},\ P(X^{(1)}=3 | Y=-1) = \frac{1}{6}
$$

$$
P(X^{(2)}=S | Y=-1) = \frac{3}{6},\ P(X^{(2)}=M | Y=-1) = \frac{2}{6},\ P(X^{(2)}=L | Y=-1) = \frac{1}{6}
$$

（2）对于给定的 $x = (2, S)^T$ 计算：

$$
P(Y=1)P(X^{(1)}=2 | Y=1)P(X^{(2)}=S | Y=1) = \frac{9}{15} \cdot \frac{3}{9} \cdot \frac{1}{9} = \frac{1}{45}
$$

$$
P(Y=-1)P(X^{(1)}=2 | Y=-1)P(X^{(2)}=S | Y=-1) = \frac{6}{15} \cdot \frac{2}{6} \cdot \frac{3}{6} = \frac{1}{15}
$$

（3）因为 $P(Y=-1)P(X^{(1)}=2 | Y=-1)P(X^{(2)}=S | Y=-1)$ 最大，所以 $y = -1$。

### 例 4.2

问题同例 4.1，按照拉普拉斯平滑估计概率，即取 $\lambda = 1$。

**解** $A_1 = \{1, 2, 3\}$，$A_2 = \{S, M, L\}$，$C=\{1, -1\}$。计算下列概率：

$$
P(Y=1) = \frac{10}{17},\ P(Y=-1) = \frac{7}{17}
$$

$$
P(X^{(1)}=1 | Y=1) = \frac{3}{12},\ P(X^{(1)}=2 | Y=1) = \frac{4}{12},\ P(X^{(1)}=3 | Y=1) = \frac{5}{12}
$$

$$
P(X^{(2)}=S | Y=1) = \frac{2}{12},\ P(X^{(2)}=M | Y=1) = \frac{5}{12},\ P(X^{(2)}=L | Y=1) = \frac{5}{12}
$$

$$
P(X^{(1)}=1 | Y=-1) = \frac{4}{9},\ P(X^{(1)}=2 | Y=-1) = \frac{3}{9},\ P(X^{(1)}=3 | Y=-1) = \frac{2}{9}
$$

$$
P(X^{(2)}=S | Y=-1) = \frac{4}{9},\ P(X^{(2)}=M | Y=-1) = \frac{3}{9},\ P(X^{(2)}=L | Y=-1) = \frac{2}{9}
$$

对于给定的 $x = (2, S)^T$ 计算：

$$
P(Y=1)P(X^{(1)}=2 | Y=1)P(X^{(2)}=S | Y=1) = \frac{9}{15} \cdot \frac{3}{9} \cdot \frac{1}{9} = \frac{5}{135} = 0.0327
$$

$$
P(Y=-1)P(X^{(1)}=2 | Y=-1)P(X^{(2)}=S | Y=-1) = \frac{6}{15} \cdot \frac{2}{6} \cdot \frac{3}{6} = \frac{28}{459} = 0.0610
$$

由于 $P(Y=-1)P(X^{(1)}=2 | Y=-1)P(X^{(2)}=S | Y=-1)$ 最大，所以 $y = -1$。